# TaxBridge Production Environment Configuration Template
# Copy this to .env.production and populate with actual credentials

# ======================
# Server Configuration
# ======================
NODE_ENV=production
PORT=3000

# ======================
# Render Deployment (Staging + Production)
# ======================
RENDER_API_BASE_URL=https://api.render.com/v1
RENDER_SERVICE_ID=srv-d5kq9tmmcj7s73a55ds0
RENDER_DASHBOARD_URL=https://dashboard.render.com
RENDER_SERVICE_URL=https://taxbridge-zdui.onrender.com
RENDER_DEPLOY_BRANCH=master
# Export RENDER_API_TOKEN from secure secrets manager before running infra/scripts/render-deploy.mjs
RENDER_API_TOKEN=

# ======================
# Database (Supabase Pro)
# ======================
DATABASE_URL=postgresql://postgres:YOUR_DB_PASSWORD@db.YOUR_PROJECT_REF.supabase.co:5432/postgres
# ======================
# Redis Cache (Render Redis Starter)
# ======================
REDIS_URL=redis://default:YOUR_REDIS_PASSWORD@YOUR_REDIS_HOST:6379

# ======================
# Duplo/DigiTax (NITDA-accredited APP for NRS e-invoicing)
# ======================
# OAuth 2.0 Client Credentials
DUPLO_CLIENT_ID=your_production_client_id_here
DUPLO_CLIENT_SECRET=your_production_client_secret_here
DUPLO_API_URL=https://api.duplo.co

# DigiTax settings (if separate from Duplo)
DIGITAX_API_URL=https://api.digitax.ng
DIGITAX_API_KEY=your_digitax_api_key
DIGITAX_HMAC_SECRET=your_digitax_hmac_secret
DIGITAX_MOCK_MODE=false

# ======================
# Remita Payment Gateway
# ======================
REMITA_MERCHANT_ID=your_merchant_id_here
REMITA_API_KEY=your_production_api_key_here
REMITA_SERVICE_TYPE_ID=your_service_type_id_here
REMITA_API_URL=https://login.remita.net
REMITA_WEBHOOK_SECRET=generate_random_32_char_string

# ======================
# UBL 3.0 Validation
# ======================
UBL_XSD_PATH=lib/ubl-invoice-2.1.xsd

# ======================
# SMS/USSD Providers
# ======================
# Primary provider: africastalking, infobip, or termii
COMMS_PROVIDER=africastalking

# Africa's Talking
AT_API_KEY=your_africas_talking_api_key
AT_USERNAME=your_africas_talking_username
AT_SHORTCODE=your_short_code

# Infobip (optional)
INFOBIP_API_KEY=your_infobip_api_key
INFOBIP_API_URL=https://api.infobip.com
INFOBIP_SIGNATURE_SECRET=your_infobip_webhook_secret
INFOBIP_SENDER=TaxBridge

# Termii (optional)
TERMII_API_KEY=your_termii_api_key
TERMII_API_URL=https://v3.api.termii.com
TERMII_SIGNATURE_SECRET=your_termii_webhook_secret
TERMII_SENDER=TaxBridge

# ======================
# Security
# ======================
# Comma-separated list of allowed origins for CORS
ALLOWED_ORIGINS=https://taxbridge.ng,https://app.taxbridge.ng,https://admin.taxbridge.ng

# JWT Authentication (REQUIRED)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=
JWT_REFRESH_SECRET=

# Data Encryption (REQUIRED)
# Used for encrypting TIN, NIN, and API credentials at rest
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=

# Session & Webhooks
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
SESSION_SECRET=
WEBHOOK_SECRET=

# SMS webhook signature verification (1=enabled, 0=disabled)
REQUIRE_SMS_SIGNATURE=1

# ======================
# Features
# ======================
# Enable/disable deadline reminder cron jobs
ENABLE_DEADLINE_REMINDERS=true

# Start payment worker in-process (false for separate worker service)
START_PAYMENT_WORKER=false

# Test phone number for SMS testing (optional)
TEST_PHONE_NUMBER=

# ======================
# Monitoring & Observability
# ======================
ENABLE_METRICS=true
METRICS_INTERVAL=60000

# Sentry Error Tracking & APM
# Required: Sign up at sentry.io and get your DSN
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.2

# Uptime Robot API Key (for external monitoring)
# Get from: https://uptimerobot.com/dashboard#mySettings
UPTIMEROBOT_API_KEY=
UPTIMEROBOT_ALERT_CONTACTS=

# ======================
# Slack Notifications (optional)
# ======================
SLACK_WEBHOOK_URL=

# ======================
# Container Registry (for deploy.sh)
# ======================
REGISTRY=taxbridge

# ======================
# Admin Dashboard
# ======================
# Used by admin-dashboard for backend API calls
NEXT_PUBLIC_API_URL=https://api.taxbridge.ng

# ======================
# Mobile App
# ======================
# Used by mobile app for backend API calls
EXPO_PUBLIC_API_URL=https://api.taxbridge.ng

# ======================
# Instructions
# ======================
# 1. Copy this file: cp .env.production.example .env.production
# 2. Generate secrets:
#    node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# 3. Obtain Duplo production credentials from DigiTax account
# 4. Obtain Remita merchant credentials from Remita dashboard
# 5. Set up Supabase Pro database and copy connection string
# 6. Set up Render Redis and copy connection string
# 7. Configure SMS provider (Africa's Talking recommended for Nigeria)
# 8. Never commit .env.production to version control
# Rate Limiting (15 variables)
RATE_LIMIT_API_WINDOW=60
RATE_LIMIT_API_MAX=100
# ... (see .env.example)

# Monitoring (9 variables)
ENABLE_DLQ_MONITORING=true
ENABLE_POOL_MONITORING=true
DLQ_THRESHOLD_INVOICE_SYNC=10
# ... (see .env.example)

# Connection Pooling
DATABASE_POOL_MAX=10
DATABASE_POOL_TIMEOUT_MS=5000
PRISMA_SLOW_QUERY_MS=500